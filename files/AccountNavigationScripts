var UserHelper=function(){"use strict";var i=function(n){for(var r=n+"=",u=document.cookie.split(";"),t,i=0;i<u.length;i++){for(t=u[i];t.charAt(0)===" ";)t=t.substring(1,t.length);if(t.indexOf(r)===0)return t.substring(r.length,t.length)}return null},r=function(n){var t=n.split(".")[1],i=t.replace("-","+").replace("_","/");return JSON.parse(window.atob(i))},n=function(){var u=i("COOKIE_TY.Entrance"),t,n,r;if(u)for(t=u.split("&"),n=0;n<t.length;n++)if(t[n]&&(r=t[n].split("="),r.length===2&&r[0]==="tx"))return r[1];return 0},t=function(n){try{return r(n)}catch(t){return{}}},u=function(){var i=n(),r=t(i);return r.email?!0:!1};return{getJwt:n,getClaims:t,isMember:u}},UrlService=function(){var n=function(n,t,i,r){var s,h,e,u,c,o,f;if(n.indexOf("#")>0?(h=n.indexOf("#"),s=n.substring(n.indexOf("#"),n.length)):(s="",h=n.length),sourceUrl=n.substring(0,h),e=sourceUrl.split("?"),u="",e.length>1)for(c=e[1].split("&"),o=0;o<c.length;o++)f=c[o].split("="),!0&&f[0]===t||(u==""?u="?":u+="&",u+=f[0]+"="+(f[1]?f[1]:""));return u===""&&(u="?"),r?u="?"+t+"="+i+(u.length>1?"&"+u.substring(1):""):(u!==""&&u!="?"&&(u+="&"),u+=t+"="+(i?i:"")),e[0]+u+s};return{updateQueryStringParameter:n}}(),PopupService=function(){var n=function(n){if($("#commonPopupRoot").length>0)$("#commonPopupRoot").replaceWith(n.content);else{$.fancybox.close(!0);var t=$.extend({},n);$.fancybox(t)}};return{open:n}}(),AuthenticationPopupService=function(){var n=tycommon.configuration.BasePath,t={LOGIN_POPUP:n+"/Authentication/Login",REGISTER_POPUP:n+"/Authentication/Register",FORGOTPASSWORD_POPUP:n+"/Authentication/Forgot",MATCH_THIRD_PARTY:n+"/Authentication/MatchThirdParty",THIRD_PARTY_REGISTER:n+"/Authentication/ThirdPartyRegister"},i=function(n,t){var i={requestUrl:"",requestData:null};jQuery.extend(i,t);$.ajax({type:"GET",url:i.requestUrl,data:i.requestData,success:function(t){n.content=t;PopupService.open(n)},error:function(){}})},r=function(n,r){if(n=typeof n!="undefined"?n:!0,r=typeof r!="undefined"?r:!1,tycommon.configuration.GuestCheckoutEnabled==="True"){var u=n?"?redirectAfterLogin=true":"?redirectAfterLogin=false&isGuestLoginEnabled="+r,f={requestUrl:t.LOGIN_POPUP+u};i({type:"ajax",padding:0,margin:0,wrapCSS:"default-popup"},f)}else $.TYPopupLogin()},u=function(n){if(n=typeof n!="undefined"?n:!1,tycommon.configuration.GuestCheckoutEnabled==="True"){var r="?isGuestLoginEnabled="+n,u={requestUrl:t.REGISTER_POPUP+r};i({type:"ajax",padding:0,margin:0,wrapCSS:"default-popup"},u)}else $.TYPopupLoginRegister()},f=function(){var n={requestUrl:t.FORGOTPASSWORD_POPUP};i({type:"ajax",padding:0,margin:0,wrapCSS:"default-popup"},n)},e=function(n,r,u){var f={requestUrl:t.MATCH_THIRD_PARTY,requestData:{email:n,thirdPartyUserId:r,thirdPartyServiceTypeId:u}};i({type:"ajax",padding:0,margin:0,wrapCSS:"default-popup"},f)},o=function(n,i,r,u){$.ajax({type:"GET",url:t.THIRD_PARTY_REGISTER,data:{email:n,genderType:i,thirdPartyUserId:r,thirdPartyTypeId:u},success:function(n){var t={type:"ajax",content:n,padding:0,margin:0,wrapCSS:"default-popup"};PopupService.open(t)},error:function(){}})},s=function(){$.fancybox.close()};return{openLogin:r,openRegister:u,openForgotPassword:f,openMatchThirdParty:e,openThirdPartyRegister:o,closePopup:s}}(),authenticationLoaderService=function(){var n=function(){$("#authenticationLoading").show()},t=function(){$("#authenticationLoading").hide()};return{show:n,hide:t}}();(function(n){function t(i,r){this.settings=null;this.isBasketInAction=!1;this.isBasketHtml=!1;this.isBasketRequestEnabled=!0;this.options=n.extend({},t.Defaults,r);this.constants=t.Constants;this.$element=n(i);this.isUserLoggedIn=this.options.isUserLoggedIn;this.isGuestCheckoutEnabled=this.options.isGuestCheckoutEnabled;this.userId=n("#UserId").val();this.setup()}t.Defaults={};t.Constants={};t.prototype.setup=function(){var n=this;n.registerGlobalEvents();(n.isUserLoggedIn||n.isGuestCheckoutEnabled)&&(n.setBasketItemCount(),n.registerEvents(),window.addEventListener("basketchanged",function(){n.setBasketItemCount()}))};t.prototype.setBasketItemCount=function(){var t="/Checkout/BasketItemCountSsl",i;t+="?_="+(new Date).getTime();(this.userId>0||this.isGuestCheckoutEnabled)&&(i={type:"GET",url:t,data:{},success:function(t){var i=parseInt(t);i&&i>0?(n(".basket-item-count").show(),n("#basketItemCount").html(i).show()):n(".basket-item-count").hide()}},n.ajax(i))};t.prototype.refreshNavigationMenu=function(){var t=tycommon.configuration.BasePath+"Header/AccountNavigation",i={type:"GET",url:t,xhrFields:{withCredentials:!0},data:{},success:function(t){n(n(".header .col-lg-3")[1]).html(t)}};n.ajax(i)};t.prototype.initBoutiqueTimerCountDown=function(){n.countdown.setDefaults(n.countdown.regional.tr);n(".countDown").each(function(){var t=n(this),i=new Date,r=new Date(+i+parseInt(t.attr("date-count-down"))*1e3);t.countdown({until:r,compact:!0,description:"",format:"MS"})})};t.prototype.slideBasketTab=function(t){var f=n(".basketProductList li").length,i=n(".basketProductList").attr("data-product-no"),u,r=0;t==="next"?(u=f-1===i?!1:!0,u===!0&&(r=i*120,i++),i===f-1&&n(".slideDownBox").addClass("passive"),i>1&&n(".slideUpBox").addClass("active")):t==="prev"&&(u=i<2?!1:!0,u===!0&&(r=(i-2)*120,i--),i===f-1?n(".slideDownBox").addClass("passive"):n(".slideDownBox").removeClass("passive"),i>1?n(".slideUpBox").addClass("active"):n(".slideUpBox").removeClass("active"));n(".basketProductList").css({transform:"translate(0px, -"+r+"px)","-ms-transform":"translate(0, -"+r+"px)","-webkit-transform":"translate(0, -"+r+"px)"});n(".basketProductList").attr("data-product-no",i)};t.prototype.handleEmptyBasketVisibility=function(){n(".basket-item-count").hide();n("#basketPreviewcontent").hide()};t.prototype.showBasket=function(t){var i=this,r;i.isBasketInAction?i.hideBasket():t||i.isBasketRequestEnabled?(i.isBasketInAction=!0,n.ajax({url:"/c/Basket/GetBasketPreview/",method:"get",cache:"nocache",success:function(t){var f=n(t),r=n("ul.basketProductList").data("product-count"),e=f.find("ul.basketProductList").data("product-count"),u;if(e===r&&n("ul.basketProductList").is(":visible")){i.isBasketInAction=!1;return}n("#basketPreviewcontent").html(f).show();r=e;u=n(".basketProductList li").length;u>0?(n("#basketItemCount").text(r),u<3?n(".slideDownBox").addClass("passive"):n(".basketProductList").attr("data-product-no",1)):i.handleEmptyBasketVisibility();i.initBoutiqueTimerCountDown();setTimeout(function(){i.isBasketRequestEnabled=!0},3e4);i.isBasketInAction=!1;i.isBasketRequestEnabled=!1},error:function(){i.isBasketInAction=!1;i.isBasketRequestEnabled=!0}})):(r=n("ul.basketProductList").data("product-count"),r===null||r==undefined||r===0?i.hideBasket():n("#basketPreviewcontent").show())};t.prototype.hideBasket=function(){n("#basketPreviewcontent").hide()};t.prototype.redirectToBasket=function(){n("#basketPreviewcontent").hide()};t.prototype.setCookie=function(n,t,i){var r=new Date,u;r.setDate(r.getDate()+i);u=escape(t)+(i==null?"":"; expires="+r.toUTCString());document.cookie=n+"="+u};t.prototype.getCookie=function(n){for(var r,u,i=document.cookie.split(";"),t=0;t<i.length;t++)if(r=i[t].substr(0,i[t].indexOf("=")),u=i[t].substr(i[t].indexOf("=")+1),r=r.replace(/^\s+|\s+$/g,""),r==n)return unescape(u)};t.prototype.registerGlobalEvents=function(){var t=this;n("#myBasketListItem").click(function(){var i=n(this);(i.hasClass("icon-container")||i.hasClass("icon-basket")||i.hasClass("nav-span")||i.hasClass("basket-item-count")||i.hasClass("basket-button-container"))&&(t.isUserLoggedIn||t.isGuestCheckoutEnabled?location.href="/c/sepetim#/basket":(t.setCookie("redirectToFavorites","true",-1),t.setCookie("redirectToBasket","true",6e4),AuthenticationPopupService.openLogin()))});n("#favoritesButton").click(function(){if(t.isUserLoggedIn){var i=n(this).attr("data-url");location.href=i}else t.setCookie("redirectToBasket","true",-1),t.setCookie("redirectToFavorites","true",6e4),AuthenticationPopupService.openLogin()});n(".account-button.login").click(function(n){n.stopPropagation();t.setCookie("redirectToBasket","true",-1);t.setCookie("redirectToFavorites","true",-1);AuthenticationPopupService.openLogin()});n(".account-button.register").click(function(n){n.stopPropagation();t.setCookie("redirectToBasket","true",-1);t.setCookie("redirectToFavorites","true",-1);AuthenticationPopupService.openRegister()});n(".login-register-button-container").click(function(n){(n.stopPropagation(),t.userId>0)||(t.setCookie("redirectToBasket","true",-1),t.setCookie("redirectToFavorites","true",-1),AuthenticationPopupService.openLogin())});n(document).ready(function(){var i,r,u;t.userId>0&&(i=t.getCookie("redirectToBasket"),r=t.getCookie("redirectToFavorites"),i==="true"&&(t.setCookie("redirectToBasket","true",-1),setTimeout(function(){location.href="/c/sepetim#/basket"},200)),r==="true"&&(t.setCookie("redirectToFavorites","true",-1),u=n("#favoritesButton").attr("data-url"),setTimeout(function(){location.href=u},200)));t.setCookie("redirectToBasket","true",-1)})};t.prototype.registerEvents=function(){var t=this;n(document).delegate(t.options.basketListItemSelector,"mouseenter",function(){t.showBasket(!0)});n(document).delegate(t.options.basketListItemSelector,"mouseleave",function(){t.hideBasket()});n("#basketPreviewcontent").delegate(".slideUpBox","click",function(){n(".slideUpBox").hasClass("passive")||t.slideBasketTab("prev")});n("#basketPreviewcontent").delegate(".slideDownBox","click",function(){n(".slideDownBox").hasClass("passive")||t.slideBasketTab("next")});n("#basketPreviewcontent").delegate("a","click",function(n){var t=n.currentTarget&&n.currentTarget.href||n.target&&n.target.href;t&&(window.location.href=t)})};t.prototype.exports=function(){var t=this;return{updateBasketItemCount:n.proxy(this.setBasketItemCount,t),refreshNavigationMenu:n.proxy(this.refreshNavigationMenu,t),showBasketPreview:n.proxy(this.showBasket,t),hideBasketPreview:n.proxy(this.hideBasket,t)}};t.prototype.destroy=function(){};n.fn.accountNavigation=function(n){var i=[];return this.each(function(){i.push(new t(this,typeof n=="object"&&n).exports())}),i};n.fn.accountNavigation.Constructor=t})(window.jQuery),function(){function n(n,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}n.prototype=window.Event.prototype;window.CustomEvent=n}();$(document).ready(function(){var n=new UserHelper,t=n.isMember(),i=tycommon.configuration.GuestCheckoutEnabled==="True",r={isUserLoggedIn:t,isGuestCheckoutEnabled:i,basketListItemSelector:"#myBasketListItem"};tycommon=window.tycommon||{};tycommon.accountNavigation=$("#headerBasketContentArea").accountNavigation(r)[0]})